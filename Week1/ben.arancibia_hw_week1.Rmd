---
title: "Week 1 Assignment"
author: "Ben Arancibia"
date: "June 11, 2015"
output: pdf_document
---


####HA 2.1

For each of the following series (from the fma package), make a graph of the data. If transforming seems appropriate, do so and describe the effect.

```{r}
library(fma)
```

a) Monthly total of people on unemployed benefits in Australia (January 1956–July 1992).
```{r}
lambda.benefits <- BoxCox.lambda(dole)
plot(BoxCox(dole, lambda.benefits), main="Monthly People on Benefits", xlab="1956-1992", ylab="Number of people(Box-Cox transformed)")
title(main=paste("Box Cox lambda = ", signif(lambda.benefits, digits=3)), font.main=8, line=-1)
```

b) Monthly total of accidental deaths in the United States (January 1973–December 1978).
```{r}
lambda.deaths <- BoxCox.lambda(usdeaths)
plot(BoxCox(usdeaths, lambda.deaths), main="Monthly Accidental Deaths", xlab="1973-1978", ylab="Number of people(Box-Cox transformed)")
title(main=paste("Box Cox lambda = ", signif(lambda.deaths, digits=3)), font.main=8, line=-1)
```

c) Quarterly production of bricks (in millions of units) at Portland, Australia (March 1956–September 1994).
```{r}
lambda.bricks <- BoxCox.lambda(bricksq)
plot(BoxCox(bricksq, lambda.bricks), main="Quarterly Production Bricks", xlab="1973-1978", ylab="Number of bricks(Box-Cox transformed)")
title(main=paste("Box Cox lambda = ", signif(lambda.bricks, digits=3)), font.main=8, line=-1)
```

####HA 2.3
Consider the daily closing IBM stock prices (data set ibmclose).
a)Produce some plots of the data in order to become familiar with it.
```{r}
plot(ibmclose)
tsdisplay(ibmclose)
```
b)Split the data into a training set of 300 observations and a test set of 69 observations.
```{r}
training <- ibmclose[1:300]
test <- ibmclose[301:369]
```

c)Try various benchmark methods to forecast the training set and compare the results on the test set. Which method did best?
```{r}
ibm2 <- window(training)
ibmfit <- meanf(ibm2, h=69)
ibmfit2 <- naive(ibm2, h=69)
ibmfit3 <- snaive(ibm2, h=69)
ibmfit4 <- rwf(ibm2, h=69, drift=TRUE)

plot(ibmclose, plot.conf=FALSE, main="Forecasts of IBM Close")
lines(ibmfit$mean,col=5)
lines(ibmfit2$mean,col=2)
lines(ibmfit3$mean,col=3)
lines(ibmfit4$mean,col=4)
legend("bottomleft",lty=1,col=c(5,2,3,4),
legend=c("Mean method","Naive method","Seasonal naive method", "Drift Method"))

```

The Drift Method did the best. One thing to note is that when I plot the seasonal naive method and the naive method, they are on top of each other. It makes it look like one did not plot, but one just obscures the other.

####HA 2.4

Consider the sales of new one-family houses in the USA, Jan 1973 – Nov 1995 (data set hsales).
a) Produce some plots of the data in order to become familiar with it.
```{r}
plot(hsales)
```
b)Split the hsales data set into a training set and a test set, where the test set is the last two years of data.
```{r}
training2 <- hsales[1:252]
test2 <- hsales[253:275]
```
c)Try various benchmark methods to forecast the training set and compare the results on the test set. Which method did best?
```{r}
hs2 <- window(hsales , end=1993)
plot(hsales,main="Home sales Until 1993",
  ylab="",xlab="Day",xlim=c(1973,1993))
lines(meanf(hs2,h=23)$mean,col=4)
lines(snaive(hs2, h=23)$mean,col=5)
lines(rwf(hs2,h=23)$mean,col=2)
lines(rwf(hs2,drift=TRUE,h=23)$mean,col=3)
legend("topright",lty=1,col=c(4, 5 ,2 ,3),
  legend=c("Mean method","Seasonal Naive","Naive method","Drift method"))
```

